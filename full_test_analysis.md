# 전체 Full Test 결과 분석 (695개 샘플)

## 실행 일시
2025-12-20

## 전체 정확도

```
전체 정확도: 59.71% (415/695)
100개 샘플: 78.00%
차이: -18.3%p ⚠️⚠️⚠️
```

### 심각한 문제: 과적합(Overfitting)

100개 샘플에서는 78% 정확도를 보였지만, 전체 695개에서는 59.71%로 **18.3%p 하락**했습니다.
이는 프롬프트가 100개 샘플에 나타난 패턴에만 최적화되었음을 의미합니다.

---

## 도메인별 정확도 전체 분석

### Tier 1: 우수한 성능 (75%+) ✅

| 도메인 | 정확도 | 샘플 수 | 비고 |
|--------|--------|---------|------|
| 분리보관 | 100.00% | 4 | 샘플 적음 |
| 해피콜 | 88.89% | 9 | 샘플 적음 |
| 고객정보 | 83.33% | 12 | |
| 대출 | 81.25% | 32 | |
| 연금 | 80.00% | 25 | |
| 변액 펀드 | 78.95% | 19 | |
| 보험금 보장 | 77.27% | 66 | 100개 샘플: 81.25% → 하락 |
| 법 제도 | 76.92% | 39 | |
| 계약해지 | 76.19% | 21 | |
| 헬스케어서비스 | 75.00% | 12 | |
| 바이탈리티 | 75.00% | 8 | 샘플 적음 |

### Tier 2: 평균 성능 (50-75%) ⚠️

| 도메인 | 정확도 | 샘플 수 | 주요 혼동 |
|--------|--------|---------|----------|
| 명의변경 | 63.46% | 52 | → 제지급 (11건) |
| 채권압류 질권설정 | 60.00% | 15 | |
| 계약정보 | 58.65% | 133 | → 보험료납입 (18건), 증명서 (13건) |
| 증명서 안내장 | 56.52% | 23 | |
| 보험료납입 | 56.52% | 69 | → 계약정보 (10건) |

### Tier 3: 심각한 실패 (0-50%) ⚠️⚠️⚠️

| 도메인 | 정확도 | 샘플 수 | 상태 | 주요 혼동 |
|--------|--------|---------|------|----------|
| 제지급 | 46.39% | 97 | 100개: 52.94% → 추가 하락 | → 계약해지 (9건), 보험금 보장 (8건) |
| 설계사 | 16.67% | 6 | 거의 실패 | |
| 민원 | 14.29% | 14 | 거의 실패 | → 계약해지 (9건) |
| **채널 표기 코드** | **0.00%** | **29** | **완전 실패** | → 민원 (6건), 고객정보 (6건) |
| **신계약 미결** | **0.00%** | **10** | **완전 실패** | → 계약정보 (5건) |

---

## 주요 혼동 패턴 Top 10 분석

### 1. 계약정보 → 보험료납입 (18건)

**실패 사례**:
```
1. "계약자에게 미납안내가 된 경우 미납안내완료로 보나요?"
   → 모델: 보험료납입
   → 정답: 계약정보

2. "일반부활보험료 즉시출금 하려고 하는데 계약자 명의 계좌가 아니어도 가능한지?"
   → 모델: 보험료납입
   → 정답: 계약정보

3. "의료급여수급권자는 보험료 할인이 되는 제도가 있다는데 그게 뭐야?"
   → 모델: 보험료납입
   → 정답: 계약정보
```

**원인 분석**:
- "미납안내", "보험료", "할인" 키워드에 민감하게 반응
- 하지만 실제로는 계약 상태 관리(계약정보) 영역
- "부활 보험료"는 계약정보 문서에 속함 (부활 절차의 일부)

### 2. 계약정보 → 증명서 안내장 (13건)

**실패 사례**:
```
1. "부활 후 증권 재발행이 되나요?"
   → 모델: 증명서 안내장
   → 정답: 계약정보

2. "실효된 계약도 증권재발행이 되나?"
   → 모델: 증명서 안내장
   → 정답: 계약정보
```

**원인 분석**:
- "증권 재발행" 키워드만 보고 증명서 안내장으로 분류
- 하지만 질문의 핵심은 "부활/실효 상태에서 재발행 가능한가?" (계약 상태)

### 3. 명의변경 → 제지급 (11건)

**실패 사례**:
```
1. "제사수익자 은행에서 개인으로 변경할 때 우편접수 시 필요한 서류는?"
   → 모델: 제지급
   → 정답: 명의변경

2. "만기수익자 변경할 때 필요한 서류는 무엇인지?"
   → 모델: 제지급
   → 정답: 명의변경
```

**원인 분석**:
- "수익자 변경"이 두 도메인 모두에 포함됨
- 제지급: 지급 시점에 수익자 확인/변경
- 명의변경: 사전에 수익자 정보 변경
- 프롬프트에 명확한 구분이 없음

### 4. 보험료납입 → 계약정보 (10건)

**실패 사례**:
```
1. "해약시 남은 보험료는 일할 계산하여 반환되나요?"
   → 모델: 계약정보
   → 정답: 보험료납입

2. "감액하면 보험료는 어떻게 되나요?"
   → 모델: 계약정보
   → 정답: 보험료납입
```

**원인 분석**:
- "감액", "해약" 등의 계약 변경 키워드에 민감
- 하지만 질문은 보험료 처리에 관한 것

### 5. 제지급 → 계약해지 (9건)

**실패 사례**:
```
1. "계약자 사망으로 상속인이 전화로 청약철회 요청 시, 구비서류는?"
   → 모델: 계약해지
   → 정답: 제지급

2. "청약철회에 대한 지연이자도 발생하나요?"
   → 모델: 계약해지
   → 정답: 제지급
```

**원인 분석**:
- "청약철회"를 계약해지로 이해
- 하지만 청약철회는 보험금 반환 절차이므로 제지급 영역

### 6. 민원 → 계약해지 (9건)

**실패 사례**:
```
1. "특정 상품의 해지에 대한 불만이 접수되었을 때?"
   → 모델: 계약해지
   → 정답: 민원

2. "계약해지 과정에서 불만이 있는 경우?"
   → 모델: 계약해지
   → 정답: 민원
```

**원인 분석**:
- "해지" 키워드에만 집중
- "불만", "민원" 키워드를 인식하지 못함
- 민원 도메인 정의가 너무 간략함 (한 줄)

---

## 완전 실패 도메인 심층 분석

### 채널 표기 코드 (0/29, 0%)

**대표 실패 사례**:
```
1. "보이는 ARS 서비스가 갑자기 너무 느려요."
   → 모델: 민원
   → 정답: 채널 표기 코드

2. "AIA+ 로그인 방법에 어떤 것들이 있지?"
   → 모델: 고객정보
   → 정답: 채널 표기 코드

3. "대출이자 RTB 출금시 통장에 뭐라고 표시돼?"
   → 모델: 대출
   → 정답: 채널 표기 코드

4. "본인인증이 당일 5회이상 실패한 경우 어떻게 되나요?"
   → 모델: 고객정보
   → 정답: 채널 표기 코드
```

**혼동 분포**:
- → 민원: 6건 (보이는 ARS 불편 사항)
- → 고객정보: 6건 (로그인, 본인인증)
- → 대출: 3건 (RTB 관련)
- → 계약정보: 3건 (AIA+ 서비스)

**근본 원인**:
1. **프롬프트에 정의 없음**: 현재 프롬프트에는 "19. 채널 표기 코드: 통신채널, 방카채널, RTB, EWS, 키오스크" 한 줄만 있음
2. **키워드 부족**: "보이는 ARS", "AIA+", "본인인증", "RTB" 등 핵심 키워드 누락
3. **도메인 의미 불명확**: "채널 표기 코드"가 무엇인지 모델이 이해하지 못함

### 신계약 미결 (0/10, 0%)

**대표 실패 사례**:
```
1. "계약상태 10이 어떤 상태?"
   → 모델: 계약정보
   → 정답: 신계약 미결

2. "보험 계약 반송 안내문을 받았는데 무엇인지 문의한 경우?"
   → 모델: 계약정보
   → 정답: 신계약 미결

3. "재고지 결과 M2 보완 나온 경우 어떻게되는건지요?"
   → 모델: 보험금 보장
   → 정답: 신계약 미결

4. "부담보 설정이 되었을 경우 어떻게 해야 돼?"
   → 모델: 보험금 보장
   → 정답: 신계약 미결
```

**혼동 분포**:
- → 계약정보: 5건
- → 보험금 보장: 3건
- → 헬스케어서비스: 1건

**근본 원인**:
1. **전문 용어 미이해**: "재고지", "부담보", "M2 보완", "계약상태 10" 등
2. **프롬프트 정의 부족**: "18. 신계약 미결: 신계약 청약 후 미결, 청약 취소" 한 줄만
3. **개념 혼동**: "청약"과 "계약"의 차이를 구분하지 못함

---

## 근본 원인 분석

### 1. 프롬프트 설계의 불균형

**현재 프롬프트 구조**:
```
상세 정의 (5개 도메인):
- 보험금 보장
- 제지급
- 계약정보
- 보험료납입
- 헬스케어서비스

간략 정의 (16개 도메인):
- 명의변경, 계약해지, 증명서 안내장, 법 제도, 고객정보
- 대출, 연금, 변액 펀드, 채권압류 질권설정, 분리보관
- 민원, 설계사, 신계약 미결, 채널 표기 코드, 바이탈리티, 해피콜
```

**문제점**:
- 16개 도메인은 한 줄 정의만 있음
- 예시, 경계 케이스, 주의사항 없음
- 핵심 키워드 누락

### 2. 100개 샘플의 편향

**100개 샘플 도메인 분포**:
```
보험금 보장: 64개 (64%)
제지급: 17개 (17%)
대출: 18개 (18%)
계약해지: 1개 (1%)
```

**전체 695개 도메인 분포**:
```
계약정보: 133개 (19.1%)
제지급: 97개 (14.0%)
보험료납입: 69개 (9.9%)
보험금 보장: 66개 (9.5%)
명의변경: 52개 (7.5%)
...
채널 표기 코드: 29개 (4.2%)
신계약 미결: 10개 (1.4%)
```

**문제**:
- 100개 샘플에는 보험금 보장/제지급/대출만 집중
- 채널 표기 코드, 신계약 미결, 민원 등은 샘플에 거의 없음
- 프롬프트가 이 3개 도메인에만 최적화됨

### 3. 도메인 경계의 모호함

**명확한 구분이 없는 케이스**:

1. **수익자 변경**:
   - 명의변경: 사전에 수익자 정보 변경 절차
   - 제지급: 지급 시점에 수익자 확인/변경

2. **보험료 관련**:
   - 보험료납입: 보험료 납입 방법, 자동이체
   - 계약정보: 부활 보험료, 미납안내

3. **청약철회**:
   - 계약해지: "해지"라는 키워드
   - 제지급: 보험료 반환 절차

4. **증권 재발행**:
   - 증명서 안내장: 증권 발급 절차
   - 계약정보: 부활/실효 상태에서 재발급 가능 여부

### 4. 전문 용어 부족

**모델이 이해하지 못하는 용어**:
- **신계약 미결**: 재고지, 부담보, M2 보완, 계약상태 10
- **채널 표기 코드**: 보이는 ARS, RTB, EWS, 키오스크
- **민원**: 불만 접수, 민원 처리
- **설계사**: 모집인, MP, 수수료

---

## 개선 방향 제안

### 방안 1: 전체 도메인 상세 정의 (권장) ⭐

**목표**: 모든 21개 도메인에 대해 상세 정의 제공

**방법**:
1. 각 도메인마다 다음 정보 포함:
   - 📁 문서 내용
   - ✅ 답변 가능한 질문 예시 (3-5개)
   - ❌ 답변 불가능한 질문 (다른 도메인)
   - 핵심 키워드 리스트

2. 특히 0% 도메인 집중:
   - 채널 표기 코드: AIA+, RTB, EWS, 보이는 ARS, 키오스크, 본인인증
   - 신계약 미결: 재고지, 부담보, 청약, 미결, M2 보완

3. 혼동되는 도메인 쌍 명확화:
   - 명의변경 vs 제지급 (수익자 변경)
   - 계약정보 vs 보험료납입 (부활 보험료)
   - 계약해지 vs 제지급 (청약철회)

**예상 효과**: 59.71% → 70-75%

### 방안 2: 계층적 분류 (2-Step Classification)

**방법**:
1. **Step 1**: 대분류 (4-5개 카테고리)
   - 계약 관리 (계약정보, 계약해지, 명의변경)
   - 금전 처리 (제지급, 보험료납입, 대출)
   - 보장 관련 (보험금 보장, 헬스케어서비스)
   - 기타 서비스 (증명서, 민원, 채널)

2. **Step 2**: 세부 분류 (각 카테고리 내)

**장점**: 경계가 모호한 도메인 간 혼동 감소
**단점**: 2회 API 호출 필요 (비용/시간 증가)

### 방안 3: Few-Shot Learning + Domain Examples

**방법**:
1. 각 도메인별 성공 사례 2-3개 프롬프트에 포함
2. 혼동되는 경계 케이스 명시적으로 제시

**예**:
```
신계약 미결 예시:
✅ "재고지 결과 M2 보완 나온 경우?" → 신계약 미결
❌ "계약 조회하고 싶어요" → 계약정보
```

**예상 효과**: 59.71% → 65-70%
**문제**: 프롬프트 길이 대폭 증가 (토큰 비용)

### 방안 4: Domain-Specific Keywords Mapping

**방법**:
프롬프트에 각 도메인의 핵심 키워드 명시적으로 매핑

```
채널 표기 코드 키워드:
- AIA+, 보이는 ARS, RTB, EWS, 키오스크
- 본인인증, 로그인, 앱, 모바일
- 통신채널, 방카채널

신계약 미결 키워드:
- 재고지, 부담보, 청약, 미결, 반송
- M2 보완, 계약상태 10
- 승낙전, 인수 심사
```

**예상 효과**: 특히 0% 도메인 개선에 효과적

---

## 권장 조치 사항

### 단기 (우선순위 높음)

1. **0% 도메인 긴급 개선**
   - 채널 표기 코드 (29개 샘플)
   - 신계약 미결 (10개 샘플)
   - 핵심 키워드와 예시 추가

2. **주요 혼동 패턴 해결**
   - 계약정보 ↔ 보험료납입 (18+10=28건)
   - 명의변경 ↔ 제지급 (11건)
   - 계약정보 → 증명서 안내장 (13건)

3. **도메인 경계 명확화**
   - "수익자 변경": 명의변경 vs 제지급
   - "보험료": 계약정보 vs 보험료납입
   - "청약철회": 계약해지 vs 제지급

### 중기

4. **전체 21개 도메인 상세 정의 작성**
   - 현재 5개 → 21개로 확장
   - domain_definitions.md 참고하여 프롬프트 재구성

5. **도메인별 Few-Shot 예시 추가**
   - domain_success_examples.txt 활용
   - 각 도메인당 2-3개 예시

### 장기

6. **데이터셋 재평가**
   - Ground Truth 검토 (특히 경계 케이스)
   - 도메인 정의 자체 재검토 필요할 수 있음

7. **계층적 분류 시스템 검토**
   - 2-Step Classification 프로토타입
   - 비용 대비 효과 측정

---

## 예상 개선 효과

| 조치 | 현재 | 예상 | 개선폭 |
|------|------|------|--------|
| 0% 도메인 키워드 추가 | 0% | 40-50% | +40-50%p |
| 전체 도메인 상세 정의 | 59.71% | 70-75% | +10-15%p |
| Few-Shot 예시 추가 | 70% | 75-80% | +5-10%p |
| 계층적 분류 | 75% | 80-85% | +5-10%p |

**최종 목표**: 80-85% 정확도 달성 가능

---

## 결론

1. **현 상태**: 59.71% (목표 75-85%에 미달)

2. **주요 문제**:
   - 프롬프트가 100개 샘플에 과적합
   - 16개 도메인 정의 부족 (한 줄만)
   - 채널 표기 코드, 신계약 미결 완전 실패
   - 도메인 경계 모호함

3. **우선 조치**:
   - 0% 도메인 긴급 개선 (키워드 + 예시)
   - 주요 혼동 패턴 해결 (28건)
   - 전체 도메인 상세 정의 확장

4. **기대 효과**:
   - 단기: 59.71% → 70-75%
   - 중기: 75-80% (Few-Shot 추가)
   - 장기: 80-85% (계층적 분류)
